# 故障排除指南

## 常见问题和解决方案

### 1. 录制启动失败：A target tab is required when called from a service worker context

**问题描述**：点击录制按钮时出现此错误

**解决方案**：
1. 打开Chrome浏览器，在地址栏输入：`chrome://extensions/`
2. 找到"SaaS Video Recorder"扩展
3. 点击扩展右下角的刷新按钮（🔄）
4. 确保扩展已启用（开关为蓝色）
5. 重新打开扩展并尝试录制

**根本原因**：Chrome扩展的service worker需要正确的标签页权限配置

### 2. 选择标签页后没有开始录制

**问题描述**：用户选择了要录制的标签页，但录制没有实际开始

**调试步骤**：
1. 打开 `debug-recorder.html` 调试工具
2. 依次点击"测试权限请求"、"测试媒体流"、"测试录制器"
3. 查看调试日志中的详细信息

**常见原因和解决方案**：
- **getUserMedia约束问题**：现代浏览器不支持`mandatory`约束
- **媒体流无效**：检查视频轨道状态和readyState
- **MediaRecorder配置问题**：MIME类型不支持或比特率设置过高

**快速修复**：
1. 确保Chrome版本为88+
2. 检查浏览器控制台的错误信息
3. 尝试重新加载扩展
4. 使用调试工具验证每个步骤

### 2. 权限被拒绝错误

**问题描述**：浏览器提示权限被拒绝

**解决方案**：
1. 点击地址栏左侧的锁图标
2. 确保相关权限设置为"允许"
3. 刷新页面并重新尝试

### 3. 扩展无法加载

**问题描述**：扩展图标不显示或无法点击

**解决方案**：
1. 确保Chrome版本为88+
2. 检查扩展是否正确安装
3. 重启Chrome浏览器
4. 重新安装扩展

### 4. 视频处理失败

**问题描述**：录制完成但背景处理失败

**解决方案**：
1. 选择"直接下载"跳过背景处理
2. 关闭其他浏览器标签页释放内存
3. 尝试录制较短的视频

### 5. 下载失败

**问题描述**：视频无法下载到本地

**解决方案**：
1. 检查浏览器下载设置
2. 确保有足够的磁盘空间
3. 检查下载文件夹权限

## 开发者调试

### 查看扩展日志
1. 打开`chrome://extensions/`
2. 找到扩展，点击"详细信息"
3. 点击"检查视图"中的"service worker"
4. 查看控制台日志

### 查看popup日志
1. 右键点击扩展图标
2. 选择"检查"
3. 查看控制台日志

### 重新加载扩展
1. 在`chrome://extensions/`页面
2. 点击扩展的刷新按钮
3. 或者关闭再重新启用扩展

## 浏览器兼容性

### 支持的浏览器
- ✅ Chrome 88+（推荐）
- ✅ Edge 88+
- ⚠️ Firefox 87+（部分功能）
- ⚠️ Safari 14+（部分功能）

### 必需的API支持
- MediaRecorder API
- getDisplayMedia API
- Chrome Extension Manifest V3
- Canvas API
- Downloads API

## 性能优化建议

### 系统要求
- **内存**：建议4GB以上
- **CPU**：建议4核心以上
- **网络**：建议3G以上
- **存储**：确保有足够空间存储视频

### 使用建议
- 录制时长控制在5分钟以内
- 关闭不必要的浏览器标签页
- 避免同时运行其他录制软件
- 定期清理浏览器缓存

## 联系支持

如果以上解决方案都无法解决问题，请：

1. 记录详细的错误信息
2. 提供浏览器版本和操作系统信息
3. 描述重现问题的具体步骤
4. 检查浏览器控制台的错误日志

## 更新日志

### v1.0.0
- 修复了service worker中desktopCapture API的调用问题
- 添加了tabs权限以支持当前标签页检测
- 改进了错误处理和用户反馈机制
- 增加了详细的故障排除指南