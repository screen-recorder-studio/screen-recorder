<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MP4 æ”¯æŒæ£€æŸ¥</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        .warning { background-color: #fff3cd; color: #856404; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f8f9fa;
        }
        .supported { background-color: #d4edda; }
        .not-supported { background-color: #f8d7da; }
    </style>
</head>
<body>
    <h1>ğŸ” MP4 æ”¯æŒæ£€æŸ¥</h1>
    
    <div id="results"></div>

    <script>
        function checkMP4Support() {
            const resultsDiv = document.getElementById('results');
            
            // æ£€æŸ¥å„ç§ MP4 MIME ç±»å‹
            const mp4Types = [
                'video/mp4',
                'video/mp4;codecs=h264',
                'video/mp4;codecs=avc1.42E01E',
                'video/mp4;codecs=avc1.4D401E', 
                'video/mp4;codecs=avc1.64001E',
                'video/mp4;codecs="avc1.42E01E"',
                'video/mp4;codecs="h264"'
            ];
            
            // æ£€æŸ¥ WebM ç±»å‹ä½œä¸ºå¯¹æ¯”
            const webmTypes = [
                'video/webm',
                'video/webm;codecs=vp8',
                'video/webm;codecs=vp9',
                'video/webm;codecs="vp8"',
                'video/webm;codecs="vp9"'
            ];
            
            let html = '<h2>MediaRecorder æ”¯æŒæ£€æŸ¥</h2>';
            
            // MP4 æ”¯æŒè¡¨æ ¼
            html += '<h3>MP4 æ ¼å¼æ”¯æŒ</h3>';
            html += '<table><tr><th>MIME ç±»å‹</th><th>æ”¯æŒçŠ¶æ€</th></tr>';
            
            let mp4Supported = false;
            for (const type of mp4Types) {
                const supported = MediaRecorder.isTypeSupported(type);
                if (supported) mp4Supported = true;
                html += `<tr class="${supported ? 'supported' : 'not-supported'}">
                    <td>${type}</td>
                    <td>${supported ? 'âœ… æ”¯æŒ' : 'âŒ ä¸æ”¯æŒ'}</td>
                </tr>`;
            }
            html += '</table>';
            
            // WebM æ”¯æŒè¡¨æ ¼
            html += '<h3>WebM æ ¼å¼æ”¯æŒ</h3>';
            html += '<table><tr><th>MIME ç±»å‹</th><th>æ”¯æŒçŠ¶æ€</th></tr>';
            
            let webmSupported = false;
            for (const type of webmTypes) {
                const supported = MediaRecorder.isTypeSupported(type);
                if (supported) webmSupported = true;
                html += `<tr class="${supported ? 'supported' : 'not-supported'}">
                    <td>${type}</td>
                    <td>${supported ? 'âœ… æ”¯æŒ' : 'âŒ ä¸æ”¯æŒ'}</td>
                </tr>`;
            }
            html += '</table>';
            
            // æ€»ç»“
            html += '<h3>æ€»ç»“</h3>';
            if (mp4Supported) {
                html += '<div class="result success">âœ… æµè§ˆå™¨æ”¯æŒ MP4 å½•åˆ¶</div>';
            } else {
                html += '<div class="result error">âŒ æµè§ˆå™¨ä¸æ”¯æŒ MP4 å½•åˆ¶</div>';
                html += '<div class="result warning">âš ï¸ è¿™æ„å‘³ç€ MediaRecorder æ— æ³•ç›´æ¥ç”Ÿæˆ MP4 æ–‡ä»¶</div>';
            }
            
            if (webmSupported) {
                html += '<div class="result success">âœ… æµè§ˆå™¨æ”¯æŒ WebM å½•åˆ¶</div>';
            } else {
                html += '<div class="result error">âŒ æµè§ˆå™¨ä¸æ”¯æŒ WebM å½•åˆ¶</div>';
            }
            
            // æµè§ˆå™¨ä¿¡æ¯
            html += '<h3>æµè§ˆå™¨ä¿¡æ¯</h3>';
            html += `<div class="result info">
                ç”¨æˆ·ä»£ç†: ${navigator.userAgent}<br>
                å¹³å°: ${navigator.platform}<br>
                è¯­è¨€: ${navigator.language}
            </div>`;
            
            // å»ºè®®
            html += '<h3>å»ºè®®</h3>';
            if (!mp4Supported) {
                html += `<div class="result warning">
                    <strong>é‡è¦å‘ç°ï¼š</strong><br>
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ MP4 å½•åˆ¶ï¼Œè¿™æ„å‘³ç€ï¼š<br>
                    â€¢ MediaRecorder æ— æ³•ç›´æ¥ç”Ÿæˆ MP4 æ–‡ä»¶<br>
                    â€¢ æ‰€æœ‰çš„ "MP4 è½¬ç " å®é™…ä¸Šéƒ½æ˜¯ WebM æ–‡ä»¶<br>
                    â€¢ éœ€è¦çœŸæ­£çš„è½¬ç åº“æ¥ç”Ÿæˆ MP4<br><br>
                    
                    <strong>è§£å†³æ–¹æ¡ˆï¼š</strong><br>
                    1. ä½¿ç”¨ FFmpeg.wasm è¿›è¡ŒçœŸæ­£çš„æ ¼å¼è½¬æ¢<br>
                    2. æˆ–è€…æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·ä¸‹è½½çš„æ˜¯ WebM æ ¼å¼<br>
                    3. æˆ–è€…æä¾›æœåŠ¡å™¨ç«¯è½¬ç æœåŠ¡
                </div>`;
            }
            
            resultsDiv.innerHTML = html;
        }
        
        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œæ£€æŸ¥
        window.onload = checkMP4Support;
    </script>
</body>
</html>
