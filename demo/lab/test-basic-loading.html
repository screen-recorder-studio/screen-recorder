<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸºç¡€åŠ è½½æµ‹è¯•</title>
</head>
<body>
    <h1>ğŸ§ª åŸºç¡€åŠ è½½æµ‹è¯•</h1>
    <div id="test-results"></div>

    <!-- ç¬¬ä¸‰æ–¹åº“ -->
    <script type="module">
        // åŠ¨æ€å¯¼å…¥ Mediabunny å¹¶è®¾ç½®ä¸ºå…¨å±€å˜é‡
        import * as Mediabunny from './libs/mediabunny.js';
        window.Mediabunny = Mediabunny;
        console.log('âœ… Mediabunny åº“å·²åŠ è½½ä¸ºå…¨å±€å˜é‡');
        
        // æµ‹è¯•åŸºæœ¬åŠŸèƒ½
        setTimeout(() => {
            testBasicLoading();
        }, 1000);
    </script>

    <!-- Mediabunny MP4 å¯¼å‡ºå™¨ -->
    <script src="popup/mediabunny-mp4-exporter.js"></script>

    <script>
        function testBasicLoading() {
            const results = document.getElementById('test-results');
            let html = '<h2>æµ‹è¯•ç»“æœ:</h2>';
            
            // æµ‹è¯• Mediabunny åº“
            if (typeof window.Mediabunny !== 'undefined') {
                html += '<p>âœ… Mediabunny åº“åŠ è½½æˆåŠŸ</p>';
                
                // æµ‹è¯•å…³é”®ç±»
                const requiredClasses = ['Input', 'Output', 'Conversion', 'BlobSource', 'Mp4OutputFormat', 'BufferTarget'];
                let allClassesAvailable = true;
                
                for (const className of requiredClasses) {
                    if (window.Mediabunny[className]) {
                        html += `<p>âœ… Mediabunny.${className} å¯ç”¨</p>`;
                    } else {
                        html += `<p>âŒ Mediabunny.${className} ä¸å¯ç”¨</p>`;
                        allClassesAvailable = false;
                    }
                }
                
                if (allClassesAvailable) {
                    html += '<p><strong>ğŸ‰ Mediabunny æ‰€æœ‰å¿…éœ€ç±»éƒ½å¯ç”¨ï¼</strong></p>';
                }
            } else {
                html += '<p>âŒ Mediabunny åº“æœªåŠ è½½</p>';
            }
            
            // æµ‹è¯• MediabunnyMp4Exporter
            if (typeof window.MediabunnyMp4Exporter !== 'undefined') {
                html += '<p>âœ… MediabunnyMp4Exporter ç±»åŠ è½½æˆåŠŸ</p>';
                
                try {
                    const exporter = new MediabunnyMp4Exporter();
                    html += '<p>âœ… MediabunnyMp4Exporter å®ä¾‹åŒ–æˆåŠŸ</p>';
                    html += `<p>ğŸ“Š æ”¯æŒçŠ¶æ€: ${exporter.isSupported ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ'}</p>`;
                } catch (error) {
                    html += `<p>âŒ MediabunnyMp4Exporter å®ä¾‹åŒ–å¤±è´¥: ${error.message}</p>`;
                }
            } else {
                html += '<p>âŒ MediabunnyMp4Exporter ç±»æœªåŠ è½½</p>';
            }
            
            results.innerHTML = html;
        }
    </script>
</body>
</html>
